
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Project - Interactive View</title>
    <style>
        
    body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: #1a1a1a; color: #fff; overflow: hidden; display: flex; height: 100vh; }
    
    /* Sidebar */
    #sidebar { width: 250px; background: #252525; border-right: 1px solid #333; display: flex; flex-direction: column; z-index: 10; boxShadow: 2px 0 10px rgba(0,0,0,0.3); }
    .sidebar-header { padding: 20px; border-bottom: 1px solid #333; background: #2d2d2d; }
    .sidebar-header h2 { margin: 0; font-size: 18px; color: #3182ce; letter-spacing: 1px; }
    .layer-list { flex: 1; padding: 20px; overflow-y: auto; }
    .layer-item { display: flex; items-center; margin-bottom: 12px; cursor: pointer; user-select: none; padding: 8px; border-radius: 4px; transition: background 0.2s; }
    .layer-item:hover { background: #333; }
    .layer-item input { margin-right: 10px; accent-color: #3182ce; cursor: pointer; }
    .project-info { padding: 20px; border-top: 1px solid #333; font-size: 12px; color: #666; text-align: center; }

    /* Viewer */
    #viewer { flex: 1; position: relative; background: #1a1a1a; cursor: grab; }
    #viewer:active { cursor: grabbing; }
    svg { width: 100%; height: 100%; display: block; }

    /* Draggable Panel (BOM) */
    .draggable-panel { position: absolute; background: #252525; border: 1px solid #444; border-radius: 6px; box-shadow: 0 4px 20px rgba(0,0,0,0.4); min-width: 250px; overflow: hidden; z-index: 100; }
    .panel-header { padding: 10px 15px; background: #2d2d2d; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; cursor: move; font-weight: bold; font-size: 14px; user-select: none; }
    .panel-header button { background: none; border: none; color: #888; cursor: pointer; font-size: 18px; padding: 0 5px; }
    .panel-header button:hover { color: #fff; }
    .panel-content { padding: 0; }
    
    /* Table */
    .bom-table { width: 100%; border-collapse: collapse; font-size: 13px; }
    .bom-table th { text-align: left; padding: 10px 15px; background: #222; color: #888; font-weight: normal; border-bottom: 1px solid #333; }
    .bom-table td { padding: 10px 15px; border-bottom: 1px solid #333; }
    .bom-table tr:last-child td { border-bottom: none; }

    </style>
</head>
<body>
    <!-- Sidebar -->
    <div id="sidebar">
        <div class="sidebar-header">
            <h2>Layers</h2>
        </div>
        <div class="layer-list">
            <label class="layer-item">
                <input type="checkbox" checked onchange="toggleLayer('layer-walls')">
                <span>Walls</span>
            </label>
            <label class="layer-item">
                <input type="checkbox" checked onchange="toggleLayer('layer-furniture')">
                <span>Furniture</span>
            </label>
             <label class="layer-item">
                <input type="checkbox" checked onchange="toggleLayer('layer-anchors')">
                <span>Anchors</span>
            </label>
            <label class="layer-item">
                <input type="checkbox" checked onchange="toggleLayer('layer-cables')">
                <span>Cables</span>
            </label>
            <label class="layer-item">
                <input type="checkbox" checked onchange="toggleLayer('layer-heatmap')">
                <span>Signal Heatmap</span>
            </label>
             <label class="layer-item">
                <input type="checkbox" checked onchange="toggleLayer('layer-bom')">
                <span>Bill of Materials</span>
            </label>
        </div>
        <div class="project-info">
            <h3>Test Project</h3>
            <p>Generated by AnchorCAD</p>
            <p>1/19/2026</p>
        </div>
    </div>

    <!-- Main Viewer -->
    <div id="viewer">
        <svg id="main-svg" viewBox="900 900 1200 1200" preserveAspectRatio="xMidYMid meet">
            <defs>
                <pattern id="grid" width="50" height="50" patternUnits="userSpaceOnUse" x="900" y="900">
                    <path d="M 50 0 L 0 0 0 50" fill="none" stroke="#2a2a2a" stroke-width="1"/>
                </pattern>
            </defs>
            <rect x="-9100" y="-9100" width="21200" height="21200" fill="#1a1a1a" />
            <rect x="-9100" y="-9100" width="21200" height="21200" fill="url(#grid)" />
            
            <!-- Layers -->
            
        <g id="layer-walls">
        <line x1="1000" y1="1000" x2="2000" y2="1000" 
              stroke="#888" stroke-width="5" stroke-linecap="round" />
    
        <line x1="2000" y1="1000" x2="2000" y2="2000" 
              stroke="#888" stroke-width="5" stroke-linecap="round" />
    </g>
        <g id="layer-furniture"><!-- Furniture placeholder --></g>
        <g id="layer-heatmap" style="display:none; opacity: 0.5;"><!-- Heatmap Image would go here --></g>
        <g id="layer-cables"></g>
        <g id="layer-anchors">
        <g transform="translate(1500, 1500)">
            <circle r="50" fill="rgba(66, 153, 225, 0.2)" stroke="#4299e1" stroke-width="1" />
            <circle r="5" fill="#3182ce" />
            <text y="-10" text-anchor="middle" fill="#a0aec0" font-family="sans-serif" font-size="10">a1</text>
        </g>
    </g>
    
        </svg>

        <!-- Draggable BOM -->
        <div id="layer-bom" class="draggable-panel" style="top: 20px; right: 20px;">
            <div class="panel-header" onmousedown="startDrag(event, 'layer-bom')">
                <span>Bill of Materials</span>
                <button onclick="document.getElementById('layer-bom').style.display='none'">Ã—</button>
            </div>
            <div class="panel-content">
                
        <table class="bom-table">
            <thead>
                <tr>
                    <th>Item</th>
                    <th>Count / Length</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Anchors</td>
                    <td>1 units</td>
                </tr>
                <tr>
                    <td>Cable Runs</td>
                    <td>0 segments</td>
                </tr>
                 <tr>
                    <td>Total Wall Length</td>
                    <td>40.00 m</td>
                </tr>
            </tbody>
        </table>
    
            </div>
        </div>
    </div>

    <script>
        
    // Pan and Zoom Logic
    const svg = document.getElementById('main-svg');
    let viewBox = { x: 900, y: 900, w: 1200, h: 1200 };
    let isPanning = false;
    let startPoint = { x: 0, y: 0 };

    function updateViewBox() {
        svg.setAttribute('viewBox', `${viewBox.x} ${viewBox.y} ${viewBox.w} ${viewBox.h}`);
    }

    svg.addEventListener('mousedown', (e) => {
        isPanning = true;
        startPoint = { x: e.clientX, y: e.clientY };
    });

    window.addEventListener('mousemove', (e) => {
        if (isPanning) {
            const dx = (e.clientX - startPoint.x) * (viewBox.w / svg.clientWidth);
            const dy = (e.clientY - startPoint.y) * (viewBox.h / svg.clientHeight);
            viewBox.x -= dx;
            viewBox.y -= dy;
            startPoint = { x: e.clientX, y: e.clientY };
            updateViewBox();
        }
    });

    window.addEventListener('mouseup', () => { isPanning = false; });

    svg.addEventListener('wheel', (e) => {
        e.preventDefault();
        const scale = e.deltaY > 0 ? 1.1 : 0.9;
        const wNew = viewBox.w * scale;
        const hNew = viewBox.h * scale;
        const dx = (viewBox.w - wNew) / 2;
        const dy = (viewBox.h - hNew) / 2;
        
        // Zoom towards pointer (refined)
        // Simple zoom center for now to avoid complexity of pointer calculation in Vanilla
        const cx = viewBox.x + viewBox.w / 2;
        const cy = viewBox.y + viewBox.h / 2;
        
        viewBox.w = wNew;
        viewBox.h = hNew;
        viewBox.x = cx - wNew / 2;
        viewBox.y = cy - hNew / 2;
        
        updateViewBox();
    });

    // Layer Toggling
    window.toggleLayer = (id) => {
        const el = document.getElementById(id);
        if (el) {
            el.style.display = el.style.display === 'none' ? 'block' : 'none';
        }
    };

    // Drag Logic for Panels
    let isDragging = false;
    let dragOffset = { x: 0, y: 0 };
    let activePanel = null;

    window.startDrag = (e, id) => {
        isDragging = true;
        activePanel = document.getElementById(id);
        const rect = activePanel.getBoundingClientRect();
        dragOffset = { x: e.clientX - rect.left, y: e.clientY - rect.top };
    };

    window.addEventListener('mousemove', (e) => {
        if (isDragging && activePanel) {
            activePanel.style.left = (e.clientX - dragOffset.x) + 'px';
            activePanel.style.top = (e.clientY - dragOffset.y) + 'px';
            activePanel.style.right = 'auto'; // Clear right if set
        }
    });

    window.addEventListener('mouseup', () => {
        isDragging = false;
        activePanel = null;
    });

    </script>
</body>
</html>
    